# -*- coding: utf-8 -*-
"""Stock_index.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/199z1-jqyzeox2Pee_8QN2HnSFSOCkOzy
"""

#! pip install yfinance

import pandas as pd
import pandas_gbq
import numpy as np
import yfinance as yf
from datetime import date
from datetime import timedelta
from google.cloud import bigquery
import pytz
from pandas.io import gbq
import matplotlib.pyplot as plt
from sklearn import linear_model

if __name__ == "__main__":

    target_index = ['^DJI','^GSPC','^IXIC']

    all_stocks = {}
    for stock in target_index:
        all_stocks[stock] = yf.download(stock, start= date.today() - timedelta(days = 40), end=date.today())
        all_stocks[stock] = all_stocks[stock].loc[:, all_stocks[stock].columns != 'Adj Close']
        all_stocks[stock].reset_index(level=0, inplace=True)

    for stock in target_index:
        all_stocks[stock].to_gbq(destination_table='stock_data.'+str(stock[-3:]),
                 project_id='bigdata6893-328419',
                 if_exists='append')

